<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Verify Email - ShortlistPro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    .animate-fade-in {
      animation: fadeIn 0.8s ease-out;
    }
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .animate-pulse-slow {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-blue-100">
  <!-- Logo in top left -->
  <div class="absolute top-6 left-6">
    <div class="flex items-center">
      <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center mr-3">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
      </div>
      <span class="text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent">ShortlistPro</span>
    </div>
  </div>

  <div class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8 animate-fade-in">
      <!-- Header -->
      <div class="text-center">
        <div class="inline-flex items-center px-4 py-2 rounded-full bg-white/60 backdrop-blur-sm border border-white/40 text-blue-600 text-sm font-medium mb-4">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          Email Verification
        </div>
        <h2 class="text-3xl font-bold text-gray-900 mb-2">Check Your Email</h2>
        <p class="text-gray-600">We've sent a 6-digit verification code to</p>
        <p class="text-blue-600 font-semibold">{{ user_email }}</p>
      </div>

      <!-- Form -->
      <div class="bg-white/80 backdrop-blur-md rounded-3xl shadow-xl border border-white/20 p-8">
        
        <!-- Messages -->
        {% if messages %}
        {% for message in messages %}
        <div class="mb-6 {% if message.tags == 'success' %}bg-green-50 border border-green-200{% elif message.tags == 'error' %}bg-red-50 border border-red-200{% else %}bg-blue-50 border border-blue-200{% endif %} rounded-xl p-4">
          <div class="flex items-center">
            {% if message.tags == 'success' %}
            <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            {% elif message.tags == 'error' %}
            <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {% else %}
            <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {% endif %}
            <p class="text-sm {% if message.tags == 'success' %}text-green-800{% elif message.tags == 'error' %}text-red-800{% else %}text-blue-800{% endif %}">
              {{ message }}
            </p>
          </div>
        </div>
        {% endfor %}
        {% endif %}

        <form method="post" class="space-y-6" x-data="{ otp: '', loading: false }">
          {% csrf_token %}
          
          <!-- Instructions -->
          <div class="text-center mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
              <div class="flex items-center justify-center mb-2">
                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center animate-pulse-slow">
                  <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                  </svg>
                </div>
              </div>
              <p class="text-blue-800 text-sm font-medium">Enter the 6-digit code from your email</p>
              <p class="text-blue-600 text-xs mt-1">Code expires in 10 minutes</p>
            </div>
          </div>

          <!-- OTP Input -->
          <div class="space-y-4">
            <label for="otp" class="block text-sm font-medium text-gray-700 text-center">
              Verification Code
            </label>
            <div class="flex justify-center">
              <input 
                type="text" 
                name="otp" 
                id="otp" 
                x-model="otp"
                maxlength="6" 
                pattern="[0-9]{6}"
                class="w-48 text-center text-2xl font-mono font-bold tracking-widest px-4 py-4 rounded-xl border-2 border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all placeholder-gray-400"
                placeholder="000000"
                autocomplete="one-time-code"
                required
                autofocus
                @input="if(otp.length === 6) { loading = true; $el.form.submit(); }"
              />
            </div>
            <p class="text-xs text-gray-500 text-center">
              Enter all 6 digits - the form will submit automatically
            </p>
          </div>

          <!-- Submit Button -->
          <div class="space-y-4">
            <button 
              type="submit"
              :disabled="otp.length < 6 || loading"
              :class="otp.length === 6 && !loading ? 'bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg transform hover:scale-105' : 'bg-gray-300 cursor-not-allowed'"
              class="w-full text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center"
            >
              <svg x-show="loading" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span x-show="!loading">Verify Email</span>
              <span x-show="loading">Verifying...</span>
            </button>

            <!-- Resend Link -->
            <div class="text-center">
              <p class="text-sm text-gray-600">
                Didn't receive the code?
                <a href="{% url 'resend_otp' user_id %}" class="font-medium text-blue-600 hover:text-blue-700 transition-colors">
                  Send new code
                </a>
              </p>
            </div>
          </div>
        </form>

        <!-- Help Text -->
        <div class="mt-6 text-center">
          <div class="bg-gray-50 border border-gray-200 rounded-xl p-4">
            <h4 class="text-sm font-medium text-gray-900 mb-2">Having trouble?</h4>
            <ul class="text-xs text-gray-600 space-y-1">
              <li>• Check your spam/junk folder</li>
              <li>• Make sure {{ user_email }} is correct</li>
              <li>• Try requesting a new code if this one expired</li>
            </ul>
          </div>
        </div>

        <!-- Back to Registration -->
        <div class="mt-6 text-center">
          <p class="text-sm text-gray-600">
            Need to change your email?
            <a href="{% url 'registration_register' %}" class="font-medium text-blue-600 hover:text-blue-700 transition-colors">
              Back to registration
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Auto-focus script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const otpInput = document.getElementById('otp');
      
      // Auto-focus the input
      otpInput.focus();
      
      // Only allow numbers
      otpInput.addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
      });
      
      // Handle paste
      otpInput.addEventListener('paste', function(e) {
        e.preventDefault();
        const pastedText = (e.clipboardData || window.clipboardData).getData('text');
        const numericText = pastedText.replace(/[^0-9]/g, '').substring(0, 6);
        this.value = numericText;
        
        // Trigger Alpine.js update
        this.dispatchEvent(new Event('input'));
      });
    });
  </script>
</body>
</html>